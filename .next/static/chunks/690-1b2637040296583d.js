"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[690],{6462:function(e,t,n){n.d(t,{Mx:function(){return d},Ry:function(){return u},UC:function(){return l},is:function(){return m},qj:function(){return h}});var r=n(4593),a=n(7513),o=n.n(a),i=n(2649);let s=(0,r.eI)("https://zaumlpbkxvjttejnxkur.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InphdW1scGJreHZqdHRlam54a3VyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTk4MTY0NTcsImV4cCI6MjAzNTM5MjQ1N30.WZNW5M-NHQMKQAUIwxBn4wmsm5ddi2odHopgiXtFUxw");async function c(e){try{return await o().hash(e,"$2b$10$abcdefghijklmnopqrstuv")}catch(e){throw Error("Error hashing password")}}async function l(e,t,n){let r=await c(t),{data:a,error:o}=await s.auth.signUp({email:e,password:r,options:{data:{username:n}}});return(await s.from("users").insert({id:a.user.id,username:n,email:e,encrypted_password:r}),o)?(console.error("Error signing up:",o),{error:o}):{data:a}}async function u(e,t){let n=await c(t),{data:r,error:a}=await s.auth.signInWithPassword({email:e,password:n});if(a)return console.error("Error signing in:",a),{error:a};let o=r.user.id,{data:i,error:l}=await s.from("users").select("username").eq("id",o).single();return l?(console.error("Error fetching user info:",l),{error:l}):(r.user.user_metadata={username:i.username},{data:r})}async function d(){let{error:e}=await s.auth.signOut();return e?(console.error("Error signing out:",e),{error:e}):(i.Z.remove("auth-token"),{message:"Successfully signed out"})}async function h(){let{data:e,error:t}=await s.auth.signInWithOAuth({provider:"google"});return t?(console.error("Error signing in with Google:",t),{error:t}):(document.cookie="loggedIn=true; path=/",{data:e})}async function m(){let{data:e,error:t}=await s.auth.getUser();return t?(console.error("Error getting user data:",t),{error:t}):(await s.from("users").insert({id:e.user.id,username:e.user.user_metadata.name,email:e.user.email}),{data:e})}},1708:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(5070),a=n(8544),o=n(2649);async function i(e,t,n,i,s,c){arguments.length>6&&void 0!==arguments[6]&&arguments[6];let l=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[],d=arguments.length>9?arguments[9]:void 0,h=arguments.length>10?arguments[10]:void 0,m="http://localhost:8000",p=[],g=[],f=[],w=[],y=[],v=o.Z.get("auth-token");if(l){let t=u?await (0,a.g)(u[0],e):null;t&&f.push(t.url)}else{let e=c.map(async e=>fetch("".concat(m,"/image/remove-background"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v)},body:JSON.stringify({url:e,content_type:"image/jpeg"})}).then(e=>{if(!e.ok)throw Error("Failed to remove background");return e.json()}));(await Promise.all(e)).forEach(e=>{f.push(e.url),u.push(e.image_id)})}let x=d.filter(e=>!0===e.has_product),b=0,I=x.map(async(e,t)=>{let n=u[b],a=r.DS.encode(f[b]);b=(b+1)%u.length;try{let t=await fetch("".concat(m,"/image/generate-product-image?prompt=").concat(e.image_script),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(v)},body:JSON.stringify({url_base64:a,no_bg_image_id:n,script_id:h})});if(!t.ok)throw Error("Failed to generate background for scene ".concat(e.scene));let r=await t.json();return r.sceneNumber=e.scene,r.has_product=e.has_product,r}catch(t){throw console.error("Error in background generation for scene ".concat(e.scene,":"),t),t}});return(await Promise.all(I)).forEach(e=>{e&&e.url&&e.image_id&&e.sceneNumber&&!0===e.has_product&&(p.push(e.url),g.push(e.image_id),w.push(e.sceneNumber),y.push(e.has_product))}),{final_images:p,imageIds:g,bgRemovedImageIds:u,sceneNumbers:w,hasProducts:y}}},3423:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(7437);function a(){return(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsxs)("div",{className:"relative w-10 h-10",children:[(0,r.jsx)("div",{className:"absolute w-full h-full rounded-full bg-blue-500 opacity-60 animate-ping"}),(0,r.jsx)("div",{className:"absolute w-full h-full rounded-full bg-blue-500 opacity-60 animate-ping animation-delay-1000"})]})})}n(2265)},418:function(e,t,n){var r=n(7437),a=n(2265),o=n(3423);let i=(0,a.forwardRef)((e,t)=>{let{title:n,message:i,outerClassName:s="",titleClassName:c="",onCancel:l,children:u,isLoading:d=!1}=e,[h,m]=(0,a.useState)(!1);return((0,a.useImperativeHandle)(t,()=>({showModal:()=>m(!0),closeModal:()=>m(!1)})),h)?(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:(0,r.jsxs)("div",{className:"flex flex-col flex-wrap bg-[#2A2A2A] py-3 px-5 rounded shadow-lg ".concat(s),children:[(0,r.jsxs)("div",{className:"flex justify-between w-full mb-5 h-[50px]",children:[(0,r.jsx)("h2",{className:"text-4xl text-[#DEDEDE] font-semibold self-end ".concat(c),children:n}),(0,r.jsx)("button",{onClick:()=>{l(),m(!1)},className:"text-white px-2 py-2 rounded self-start",children:(0,r.jsx)("img",{src:"/images/X.svg",width:12,height:12,alt:"close icon"})})]}),d?(0,r.jsx)(o.Z,{}):(0,r.jsxs)(r.Fragment,{children:[i&&(0,r.jsx)("p",{className:"mb-4",children:i}),u]})]})}):null});i.displayName="Modal",t.Z=i},4560:function(e,t,n){var r=n(7437),a=n(2265),o=n(5426);t.Z=e=>{let{children:t,direction:n="horizontal",...i}=e,[s,c]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{let e=requestAnimationFrame(()=>c(!0));return()=>{cancelAnimationFrame(e),c(!1)}},[]),s)?(0,r.jsx)(o.bK,{...i,direction:n,children:t}):null}},8544:function(e,t,n){n.d(t,{g:function(){return a}});var r=n(2649);let a=async(e,t)=>{let n=r.Z.get("auth-token"),a=await fetch("http://localhost:8000/db/get-image/".concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});return await a.json()}},6993:function(e,t,n){n.d(t,{N_:function(){return l},Ef:function(){return m},Jx:function(){return h},Tn:function(){return u},fn:function(){return d}});let r=[{title:"Headlands",genre:"Rock",mood:"Happy",artist:"National Sweatheart"},{title:"Skating On the Uppers",genre:"Jazz/Blue",mood:"Funky",artist:"Lish Grooves"},{title:"Some College",genre:"R&B/Soul",mood:"Dramatic",artist:"Lish Grooves"},{title:"A Truly Dazzling Dream",genre:"Ambient",mood:"Romance",artist:"Lish Grooves"},{title:"Arm Wrestler",genre:"Rock",mood:"Dark",artist:"National Sweatheart"},{title:"Tasty Waves",genre:"Ambient",mood:"Dramatic",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"}];var a=n(9119),o=n(2649),i=n(4593);let s="http://localhost:8000",c=(0,i.eI)("https://zaumlpbkxvjttejnxkur.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InphdW1scGJreHZqdHRlam54a3VyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTk4MTY0NTcsImV4cCI6MjAzNTM5MjQ1N30.WZNW5M-NHQMKQAUIwxBn4wmsm5ddi2odHopgiXtFUxw");async function l(e,t,n){let r=o.Z.get("auth-token");console.log(r);try{let t={number_of_product_images:n.length.toString(),title:e.title,product_description:e.product_description,video_description:e.video_description,dimension:"".concat(e.length,"x").concat(e.width,"x").concat(e.height," inches")},a=await fetch("".concat(s,"/text/generate-script"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to get backend script data: ".concat(a.statusText));return await a.json()}catch(e){throw console.error("Error adding review:",e),Error("Failed to add review")}}async function u(e,t){let n=o.Z.get("auth-token");try{let t=await fetch("".concat(s,"/text/script/?script_id=").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});if(!t.ok)throw Error("Failed to fetch review: ".concat(t.statusText));let a=await t.json();return a.promptScript="Sample prompt script from getReview.",a.musicUrl="https://sample-videos.com/audio/mp3/wave.mp3",a.dubbing='Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s\n      standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen\n      book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.\n      It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with\n      desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.\n      Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from\n      45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney College in Virginia, looked up\n      one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and going through the cites of the word in classical\n      literature, discovered the undoubtable source. Lorem Ipsum comes from sections 1.10.32 and 1.10.33 of "de Finibus Bonorum et Malorum"\n      (The Extremes of Good and Evil) by Cicero, written in 45 BC. This book is a treatise on the theory of ethics, very popular\n      during the Renaissance. The first line of Lorem Ipsum, "Lorem ipsum dolor sit amet..", comes from a line in section 1.10.32.',a.musicList=r,a}catch(e){throw console.error("Error fetching review:",e),Error("Failed to fetch review")}}async function d(e){try{let{data:t}=await c.from("Videos").select("*").eq("script_id",e).eq("type","final_video").single();return t}catch(e){throw console.error("Error fetching video data:",e),Error("Failed to fetch video data")}}async function h(e,t){try{let{data:n,error:r}=await c.from("Images").select("url, no_bg_image_id, prompt").eq("script_id",e).eq("user_id",t).in("type",["post","from_text"]).order("created_at",{ascending:!1});if(r)throw r;return n}catch(e){throw console.error("Error fetching image data:",e),Error("Failed to fetch image data")}}let m=async e=>{let t={user_id:e.sub,role:e.role,exp:e.exp,iat:e.iat,session_id:e.session_id};try{let e=new TextEncoder().encode("dWWOvdGJYdR6CdmhxndBfJHYN/3//ybrWY5FiMf09M+0w/gXvp+2w0TtFZUBhPIq4dD3xGIPmLLto6/2/L1FxA==");return await new a.N(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("12h").sign(e)}catch(e){return console.error("Invalid token:",e),null}}},8827:function(e,t,n){n.d(t,{H:function(){return c},a:function(){return l}});var r=n(7437),a=n(6462),o=n(6463),i=n(2265);let s=(0,i.createContext)(),c=e=>{let{children:t}=e,[n,c]=(0,i.useState)(null),[l,u]=(0,i.useState)(!0),d=(0,o.useRouter)(),h=(0,o.usePathname)();(0,i.useEffect)(()=>{(async()=>{let e=window.location.pathname,t=await fetch("/api/auth/session?pathname=".concat(e)),n=await t.json();if(n.user)c(n.user);else{let t=await fetch("/api/auth/refresh?pathname=".concat(e));t.ok?c((await t.json()).user):"/"!==e&&d.push("/")}u(!1)})()},[d,h]);let m=async()=>{let{error:e}=await (0,a.Mx)();e||(c(null),d.push("/"))},p=async(e,t)=>{let{data:n,error:r}=await signInWithEmail(e,t);r||c(n.user)},g=async(e,t,n)=>{let{data:r,error:a}=await signUpNewUser(e,t,n);a||c(r.user)};return(0,r.jsx)(s.Provider,{value:{user:n,loading:l,setUser:c,signOut:m,signIn:p,signUp:g},children:t})},l=()=>(0,i.useContext)(s)},1945:function(e,t,n){n.d(t,{d:function(){return i},v:function(){return s}});var r=n(7437),a=n(2265);let o=(0,a.createContext)(),i=e=>{let{children:t}=e,[n,i]=(0,a.useState)(null),[s,c]=(0,a.useState)([]),[l,u]=(0,a.useState)([]),[d,h]=(0,a.useState)(!1);return(0,r.jsx)(o.Provider,{value:{userId:n,imageIds:s,noBgImageIds:l,hasProductIndexes:d,setUserId:i,setImageIds:c,setNoBgImageIds:u,setHasProductIndexes:h},children:t})},s=()=>(0,a.useContext)(o)}}]);