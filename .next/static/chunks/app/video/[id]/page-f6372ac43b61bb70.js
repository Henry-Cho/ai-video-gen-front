(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[150],{8290:function(e,t,r){Promise.resolve().then(r.bind(r,223))},6462:function(e,t,r){"use strict";r.d(t,{Mx:function(){return d},Ry:function(){return l},UC:function(){return u},is:function(){return m},qj:function(){return h}});var n=r(4593),o=r(7513),i=r.n(o),a=r(2649);let s=(0,n.eI)("https://zaumlpbkxvjttejnxkur.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InphdW1scGJreHZqdHRlam54a3VyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTk4MTY0NTcsImV4cCI6MjAzNTM5MjQ1N30.WZNW5M-NHQMKQAUIwxBn4wmsm5ddi2odHopgiXtFUxw");async function c(e){try{return await i().hash(e,"$2b$10$abcdefghijklmnopqrstuv")}catch(e){throw Error("Error hashing password")}}async function u(e,t,r){let n=await c(t),{data:o,error:i}=await s.auth.signUp({email:e,password:n,options:{data:{username:r}}});return(await s.from("users").insert({id:o.user.id,username:r,email:e,encrypted_password:n}),i)?(console.error("Error signing up:",i),{error:i}):{data:o}}async function l(e,t){let r=await c(t),{data:n,error:o}=await s.auth.signInWithPassword({email:e,password:r});if(o)return console.error("Error signing in:",o),{error:o};let i=n.user.id,{data:a,error:u}=await s.from("users").select("username").eq("id",i).single();return u?(console.error("Error fetching user info:",u),{error:u}):(n.user.user_metadata={username:a.username},{data:n})}async function d(){let{error:e}=await s.auth.signOut();return e?(console.error("Error signing out:",e),{error:e}):(a.Z.remove("auth-token"),{message:"Successfully signed out"})}async function h(){let{data:e,error:t}=await s.auth.signInWithOAuth({provider:"google"});return t?(console.error("Error signing in with Google:",t),{error:t}):(document.cookie="loggedIn=true; path=/",{data:e})}async function m(){let{data:e,error:t}=await s.auth.getUser();return t?(console.error("Error getting user data:",t),{error:t}):(await s.from("users").insert({id:e.user.id,username:e.user.user_metadata.name,email:e.user.email}),{data:e})}},6993:function(e,t,r){"use strict";r.d(t,{N_:function(){return u},Ef:function(){return m},Jx:function(){return h},Tn:function(){return l},fn:function(){return d}});let n=[{title:"Headlands",genre:"Rock",mood:"Happy",artist:"National Sweatheart"},{title:"Skating On the Uppers",genre:"Jazz/Blue",mood:"Funky",artist:"Lish Grooves"},{title:"Some College",genre:"R&B/Soul",mood:"Dramatic",artist:"Lish Grooves"},{title:"A Truly Dazzling Dream",genre:"Ambient",mood:"Romance",artist:"Lish Grooves"},{title:"Arm Wrestler",genre:"Rock",mood:"Dark",artist:"National Sweatheart"},{title:"Tasty Waves",genre:"Ambient",mood:"Dramatic",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"},{title:"The Center Isn't Holding",genre:"R&B/Soul",mood:"Funky",artist:"National Sweatheart"}];var o=r(9119),i=r(2649),a=r(4593);let s="http://localhost:8000",c=(0,a.eI)("https://zaumlpbkxvjttejnxkur.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InphdW1scGJreHZqdHRlam54a3VyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTk4MTY0NTcsImV4cCI6MjAzNTM5MjQ1N30.WZNW5M-NHQMKQAUIwxBn4wmsm5ddi2odHopgiXtFUxw");async function u(e,t,r){let n=i.Z.get("auth-token");console.log(n);try{let t={number_of_product_images:r.length.toString(),title:e.title,product_description:e.product_description,video_description:e.video_description,dimension:"".concat(e.length,"x").concat(e.width,"x").concat(e.height," inches")},o=await fetch("".concat(s,"/text/generate-script"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(t)});if(!o.ok)throw Error("Failed to get backend script data: ".concat(o.statusText));return await o.json()}catch(e){throw console.error("Error adding review:",e),Error("Failed to add review")}}async function l(e,t){let r=i.Z.get("auth-token");try{let t=await fetch("".concat(s,"/text/script/?script_id=").concat(e),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});if(!t.ok)throw Error("Failed to fetch review: ".concat(t.statusText));let o=await t.json();return o.promptScript="Sample prompt script from getReview.",o.musicUrl="https://sample-videos.com/audio/mp3/wave.mp3",o.dubbing='Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry\'s\n      standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen\n      book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.\n      It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with\n      desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.\n      Contrary to popular belief, Lorem Ipsum is not simply random text. It has roots in a piece of classical Latin literature from\n      45 BC, making it over 2000 years old. Richard McClintock, a Latin professor at Hampden-Sydney College in Virginia, looked up\n      one of the more obscure Latin words, consectetur, from a Lorem Ipsum passage, and going through the cites of the word in classical\n      literature, discovered the undoubtable source. Lorem Ipsum comes from sections 1.10.32 and 1.10.33 of "de Finibus Bonorum et Malorum"\n      (The Extremes of Good and Evil) by Cicero, written in 45 BC. This book is a treatise on the theory of ethics, very popular\n      during the Renaissance. The first line of Lorem Ipsum, "Lorem ipsum dolor sit amet..", comes from a line in section 1.10.32.',o.musicList=n,o}catch(e){throw console.error("Error fetching review:",e),Error("Failed to fetch review")}}async function d(e){try{let{data:t}=await c.from("Videos").select("*").eq("script_id",e).eq("type","final_video").single();return t}catch(e){throw console.error("Error fetching video data:",e),Error("Failed to fetch video data")}}async function h(e,t){try{let{data:r,error:n}=await c.from("Images").select("url, no_bg_image_id, prompt").eq("script_id",e).eq("user_id",t).in("type",["post","from_text"]).order("created_at",{ascending:!1});if(n)throw n;return r}catch(e){throw console.error("Error fetching image data:",e),Error("Failed to fetch image data")}}let m=async e=>{let t={user_id:e.sub,role:e.role,exp:e.exp,iat:e.iat,session_id:e.session_id};try{let e=new TextEncoder().encode("dWWOvdGJYdR6CdmhxndBfJHYN/3//ybrWY5FiMf09M+0w/gXvp+2w0TtFZUBhPIq4dD3xGIPmLLto6/2/L1FxA==");return await new o.N(t).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("12h").sign(e)}catch(e){return console.error("Invalid token:",e),null}}},223:function(e,t,r){"use strict";r.d(t,{default:function(){return u}});var n=r(7437),o=r(2265),i=r(6463),a=r(6993),s=r(6648),c=r(8827);function u(e){let{params:t}=e,[r,u]=(0,o.useState)(null),l=(0,i.useRouter)(),d=(0,o.useRef)(!1),{user:h}=(0,c.a)();if(h||(alert("User login required"),redirect("/")),(0,o.useEffect)(()=>{let e=e=>{e.preventDefault(),e.returnValue=""},t=()=>{d.current||confirm("You may lose data and be charged again for regenerating your AI-produced video. Do you still want to go back?")?(d.current=!0,window.history.back()):window.history.pushState(null,"",window.location.href)};return window.history.pushState(null,"",window.location.href),window.addEventListener("beforeunload",e),window.addEventListener("popstate",t),()=>{window.removeEventListener("beforeunload",e),window.removeEventListener("popstate",t)}},[]),(0,o.useEffect)(()=>{(async()=>{try{let e=t.id,r=await (0,a.fn)(e);r?u(r):l.push("/")}catch(e){console.error("Error fetching video from supabase",e),l.push("/")}})()},[t.id,l]),!r)return(0,n.jsx)("div",{children:"Loading..."});let{url:m}=r;return(0,n.jsx)("main",{className:"flex flex-col items-center p-24",children:(0,n.jsxs)("div",{className:"w-full max-w-lg pt-10",children:[(0,n.jsx)("div",{className:"flex justify-center pb-10",children:(0,n.jsx)(s.default,{src:"/images/arcticons_form.svg",width:82,height:82,alt:"form icon"})}),(0,n.jsxs)("video",{controls:!0,className:"w-full",children:[(0,n.jsx)("source",{src:m,type:"video/mp4"}),"Your browser does not support the video tag."]}),(0,n.jsx)("div",{className:"mt-10 flex justify-end",children:(0,n.jsx)("button",{className:"py-2 px-8 bg-[#4F4CDB] rounded text-white",children:"Export"})})]})})}},8827:function(e,t,r){"use strict";r.d(t,{H:function(){return c},a:function(){return u}});var n=r(7437),o=r(6462),i=r(6463),a=r(2265);let s=(0,a.createContext)(),c=e=>{let{children:t}=e,[r,c]=(0,a.useState)(null),[u,l]=(0,a.useState)(!0),d=(0,i.useRouter)(),h=(0,i.usePathname)();(0,a.useEffect)(()=>{(async()=>{let e=window.location.pathname,t=await fetch("/api/auth/session?pathname=".concat(e)),r=await t.json();if(r.user)c(r.user);else{let t=await fetch("/api/auth/refresh?pathname=".concat(e));t.ok?c((await t.json()).user):"/"!==e&&d.push("/")}l(!1)})()},[d,h]);let m=async()=>{let{error:e}=await (0,o.Mx)();e||(c(null),d.push("/"))},p=async(e,t)=>{let{data:r,error:n}=await signInWithEmail(e,t);n||c(r.user)},f=async(e,t,r)=>{let{data:n,error:o}=await signUpNewUser(e,t,r);o||c(n.user)};return(0,n.jsx)(s.Provider,{value:{user:r,loading:u,setUser:c,signOut:m,signIn:p,signUp:f},children:t})},u=()=>(0,a.useContext)(s)}},function(e){e.O(0,[218,90,483,971,23,744],function(){return e(e.s=8290)}),_N_E=e.O()}]);